<div id="addNewsModal" class="modal fade in" tabindex="-1" role="dialog" aria-hidden="true"  data-backdrop="static">
    <div class="modal-dialog" style="width:1100px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="opacity: 1">×</button>
                <h4 class="modal-title" id="myModalLabel" style="text-align:left"><!-- 添加用户信息 -->添加</h4>
            </div>
            <div class="modal-body form-horizontal-body" style="padding:20px">
             <div class="row form-group" style="display:none;margin-bottom:15px">
                   <div class="col-md-12" style="">
                       <div class="form-group">
                           <div class="col-md-2 text_right pad_r">
                               <label class="control-label" style="margin-left: 33px;margin-top: 6px;font-weight: bold;">用户名称类型：</label>
                           </div>
                           <div class="col-md-9">
                               <select  id="add_type" >
								  <option  selected="selected" value ="31">图文</option>
					</select>
                           </div>
                           <span class="col-md-1 b-x" style="color:red; position:relative;right:20px;top:8px">*</span>
                       </div>
                   </div>
               </div> 
                <div class="row form-group" style="margin-bottom:15px">
                   <div class="col-md-12" style="">
                       <div class="form-group">
                           <div class="col-md-2 text_right pad_r">
                               <label class="control-label" style="margin-left: 33px;margin-top: 6px;font-weight: bold;"><!-- 用户名称 -->头像：</label>
                           </div>
                           <div class="col-md-9">
                               <!-- <input type="file" class="form-control add_file user_til"> -->
                               <input action="" type="file" name="file" id="file_submit" class="file_sub form-control add_file user_til"  onchange="ajaxFileUpload()">
                               
                               <input type="hidden" value="" id="imgaddress">
                           </div>
                            <div class="preimg col-md-9"></div>
                           <span class="col-md-1 b-x" style="color:red; position:relative;right:20px;top:8px">*</span>
                       </div>
                   </div>
               </div>
               <div class="row form-group" style="margin-bottom:15px">
                   <div class="col-md-12" style="">
                       <div class="form-group">
                           <div class="col-md-2 text_right pad_r">
                               <label class="control-label" style="margin-left: 33px;margin-top: 6px;font-weight: bold;"><!-- 用户名称 -->姓名：</label>
                           </div>
                           <div class="col-md-9">
                               <input type="text" class="form-control add_title user_til">
                           </div>
                           <span class="col-md-1 b-x" style="color:red; position:relative;right:20px;top:8px">*</span>
                       </div>
                   </div>
               </div>
                <div class="row form-group" style="margin-bottom:15px">
                   <div class="col-md-12" style="">
                       <div class="form-group">
                           <div class="col-md-2 text_right pad_r">
                               <label class="control-label" style="margin-left: 33px;margin-top: 6px;font-weight: bold;"><!-- 用户名称 -->职称：</label>
                           </div>
                           <div class="col-md-9">
                               <input type="text" class="form-control add_source user_til">
                           </div>
                           <span class="col-md-1 b-x" style="color:red; position:relative;right:20px;top:8px">*</span>
                       </div>
                   </div>
               </div>
                <div class="row form-group" style="margin-bottom:15px">
                   <div class="col-md-12" style="">
                       <div class="form-group">
                           <div class="col-md-2 text_right pad_r">
                               <label class="control-label" style="margin-left: 33px;margin-top: 6px;font-weight: bold;"><!-- 用户名称 -->简介：</label>
                           </div>
                           <div id="div4" class="col-md-9">
                               <!-- <input type="text" class="form-control add_content user_til"> -->
                           </div>
                           <span class="col-md-1 b-x" style="color:red; position:relative;right:20px;top:8px">*</span>
                       </div>
                   </div>
               </div>
               <div class="row form-group" style="margin-bottom:15px">
                   <div class="col-md-12" style="">
                       <div class="form-group">
                           <div class="col-md-2 text_right pad_r">
                               <label class="control-label" style="margin-left: 33px;margin-top: 6px;font-weight: bold;"><!-- 用户名称 -->编辑作者：</label>
                           </div>
                           <div class="col-md-9">
                               <input type="text" class="form-control add_author user_til">
                           </div>
                           <span class="col-md-1 b-x" style="color:red; position:relative;right:20px;top:8px">*</span>
                       </div>
                   </div>
               </div>
              
                
                <div class="col-lg-12">
                    <strong class='result' style="display:none;color:red;"></strong>
                </div>
                <div class="modal-footer" style="clear: both;">
                    <button type="button" class="btn btn-primary" style="background-color: #32597a; color: #fff; border:none"><!-- 保存 -->保存</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal"><!-- 取消 -->取消</button>
                    <input type="text" hidden id="b_id" />
                </div>
            </div>
        </div>
    </div>    </div>
    
<script type="text/javascript">
$('#addUserModal').on('show.bs.modal', function () {
	$("#addUserModal").find(".result").html('').hide();
});


    var E = window.wangEditor
    var editor1 = new E('#div4')
    editor1.customConfig.uploadImgShowBase64 = true
    editor1.create()

   //上传文件夹
function ajaxFileUpload() {
	var fileObj = document.getElementById("file_submit").files; // js 获取文件对象
	var fileObjs = [];
    if (fileObj.length == 0) {
        alert("请选择文件");
        return;
    }
    if(fileObj.length>0){
		for(var i=0;i<fileObj.length;i++){
            fileObjs.push(fileObj[i]);
		}
        $.each(fileObjs,function(i,fileObj){
            //判断上传的文件类型
            var typeu;
            var regex = /^.*?\.(jpg|png|jpeg|bmp|gif|JPG)$/;
            var matchdFlag = regex.test(fileObj.name);
            if(!matchdFlag){
            	alert("请选择图片文件");
                return;
            }

            var formFile = new FormData();
            formFile.append("action", "UploadVMKImagePath");
            formFile.append("file", fileObj); //加入文件对象
            formFile.append("typeu",typeu);
            //第二种 ajax 提交
            var data = formFile;
            $.ajax({
                url: 'upload/uploadFile',
                data: data,
                type: "post",
                dataType: "json",
                cache: false,//上传文件无需缓存
                processData: false,//用于对data参数进行序列化处理 这里必须false
                contentType: false, //必须
                success: function (result) {
                	debugger
                	var result=result.result;
                	$(".preimg").html("");
                	$(".preimg").append("<img src='"+result+"' height='50px'>");
                	$("#imgaddress").val(result);
                    //$('#file_submit').val(result.result);
                    // var jsonObj = $.parseJSON(result);
                    //var jsonObj = result;
                   
                },
                error: function (e)//服务器响应失败处理函数
                {
                    console.log('上传文件到服务器失败！');
                }
            });
		});
	}


}

</script>